<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MARPED ‚Äì TPN Hesaplama</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacOSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding-bottom: 80px;
      color: #333;
    }
    header {
      background: #6f42c1;
      color: white;
      padding: 16px;
      text-align: center;
    }
    .container {
      padding: 16px;
      max-width: 480px;
      margin: 0 auto;
    }
    .card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }
    label {
      display: block;
      margin: 12px 0 4px;
      font-weight: 500;
      font-size: 0.95rem;
    }
    select, input[type="number"], input[type="text"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    button {
      width: 100%;
      padding: 12px;
      margin-top: 20px;
      background: #6f42c1;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
    }
    button:hover {
      background: #5a32a3;
    }
    .result {
      margin-top: 24px;
      background: #f0f8ff;
      border: 1px solid #b3d4fc;
      border-radius: 8px;
      padding: 16px;
    }
    .result table {
      width: 100%;
      border-collapse: collapse;
    }
    .result td {
      padding: 8px 0;
      border-bottom: 1px solid #e0e0e0;
    }
    .result td:first-child {
      font-weight: 600;
      width: 55%;
    }
    .warning {
      color: #c0392b;
      font-size: 0.9rem;
      margin-top: 12px;
    }
    .note {
      font-size: 0.85rem;
      color: #555;
      margin-top: 16px;
      line-height: 1.4;
    }
    .bottom-menu {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #6f42c1;
      display: flex;
      justify-content: space-around;
      padding: 8px 0;
      z-index: 1000;
    }
    .bottom-menu a {
      color: white;
      text-decoration: none;
      font-size: 13px;
      text-align: center;
      flex: 1;
    }
    .bottom-menu span {
      font-size: 11px;
      display: block;
    }
  </style>
</head>
<body>

<header>
  <h2>TPN Hesaplama</h2>
  <p>Pediatrik Total Parenteral Beslenme</p>
</header>

<div class="container">
  <div class="card">

    <label>Hasta grubu</label>
    <select id="grup">
      <option value="">Se√ßiniz</option>
      <option value="yenidogan">Yenidoƒüan / Premat√ºre</option>
      <option value="cocuk">√áocuk (1 ay ‚Äì 10 ya≈ü)</option>
      <option value="buyuk_cocuk">B√ºy√ºk √ßocuk / Ad√∂lesan</option>
    </select>

    <label>Kilo (kg)</label>
    <input type="number" id="kg" step="0.01" min="0.4" placeholder="√ñrn: 3.45">

    <label>Toplam sƒ±vƒ± hedefi (mL/kg/g√ºn)</label>
    <input type="number" id="sivi" step="1" value="100" min="60" max="160">

    <label>Hedef enerji (kcal/kg/g√ºn)</label>
    <input type="number" id="enerji" step="1" value="80" min="40" max="120">

    <label>Protein hedefi (g/kg/g√ºn)</label>
    <input type="number" id="protein" step="0.1" value="2.5" min="1.0" max="4.0">

    <label>Lipid oranƒ± (non-protein kalorinin %)</label>
    <input type="number" id="lipid_yuzde" step="5" value="35" min="20" max="50">

    <button onclick="hesaplaTPN()">Hesapla</button>

    <div class="result" id="sonuc" style="display:none;"></div>

  </div>

  <div class="note">
    ‚ö†Ô∏è Bu deƒüerler ba≈ülangƒ±√ß √∂nerisidir.<br>
    Elektrolit, mineral, karaciƒüer/b√∂brek fonksiyonu, sepsis, refeeding riski gibi klinik duruma g√∂re ayarlanmalƒ±dƒ±r.<br>
    Hesaplamalar ESPGHAN/ESPEN √∂nerilerine dayanƒ±r. Nihai karar hekime aittir.
  </div>
</div>

<script>
function hesaplaTPN() {
  const grup   = document.getElementById("grup").value;
  const kg     = parseFloat(document.getElementById("kg").value)     || 0;
  const sivi   = parseFloat(document.getElementById("sivi").value)   || 100;
  const enerji = parseFloat(document.getElementById("enerji").value) || 80;
  const prot   = parseFloat(document.getElementById("protein").value)|| 2.5;
  const lipidY = parseFloat(document.getElementById("lipid_yuzde").value) || 35;

  if (!grup || kg <= 0) {
    alert("L√ºtfen hasta grubunu se√ßin ve ge√ßerli bir kilo girin.");
    return;
  }

  // Temel hesaplamalar
  const toplamEnerji   = enerji * kg;
  const proteinG       = prot   * kg;
  const proteinKcal    = proteinG * 4;
  const nonProteinKcal = toplamEnerji - proteinKcal;
  const lipidKcal      = nonProteinKcal * (lipidY / 100);
  const lipidG         = lipidKcal / 9;
  const glukozG        = (nonProteinKcal - lipidKcal) / 3.4;
  const toplamHacim    = sivi * kg;

  const gir            = (glukozG * 1000) / (kg * 1440);   // mg/kg/dk
  const lipidHacim20   = lipidG * 5;                        // %20 lipid ‚Üí 5 mL/g
  const kalanHacim     = toplamHacim - lipidHacim20;
  const dekstrozYuzde  = kalanHacim > 0 ? (glukozG * 10) / kalanHacim : 0;

  // Uyarƒ±lar
  let uyari = "";
  if (gir > 14) uyari += "‚Üí GIR >14 mg/kg/dk (√ßok y√ºksek olabilir)<br>";
  if (enerji < 60 && grup !== "yenidogan") uyari += "‚Üí D√º≈ü√ºk enerji (refeeding riski?)<br>";
  if (prot < 1.5) uyari += "‚Üí Protein d√º≈ü√ºk olabilir<br>";

  // Sonu√ß HTML
  let html = `
    <table>
      <tr><td>Toplam enerji</td><td>${toplamEnerji.toFixed(0)} kcal/g√ºn</td></tr>
      <tr><td>Protein</td><td>${proteinG.toFixed(1)} g/g√ºn  (${prot.toFixed(1)} g/kg)</td></tr>
      <tr><td>Lipid</td><td>${lipidG.toFixed(1)} g/g√ºn</td></tr>
      <tr><td>Glukoz / Karbonhidrat</td><td>${glukozG.toFixed(1)} g/g√ºn</td></tr>
      <tr><td>GIR</td><td><b>${gir.toFixed(1)}</b> mg/kg/dk</td></tr>
      <tr><td>Toplam sƒ±vƒ±</td><td>${toplamHacim.toFixed(0)} mL/g√ºn</td></tr>
      <tr><td>%20 Lipid sol√ºsyon</td><td>${lipidHacim20.toFixed(0)} mL</td></tr>
      <tr><td>Kalan hacim (AA + dekstroz)</td><td>${kalanHacim.toFixed(0)} mL</td></tr>
      <tr><td>Tahmini % dekstroz</td><td>${dekstrozYuzde.toFixed(1)} %</td></tr>
    </table>
  `;

  if (uyari) {
    html += `<div class="warning">${uyari}</div>`;
  }

  document.getElementById("sonuc").innerHTML = html;
  document.getElementById("sonuc").style.display = "block";
}
</script>

<div class="bottom-menu">
  <a href="index.html">üè†<br><span>Ana Men√º</span></a>
  <a href="gir.html">üßÆ<br><span>Hesap</span></a>
  <a href="fizikmuayene.html">üìù<br><span>Notlar</span></a>
</div>

</body>
</html>
